import{a as Me}from"./chunk-HTNIS4IB.js";import{a as ee}from"./chunk-LP2IO24O.js";import{$a as j,$b as xe,Ab as _e,Bb as S,Ea as ue,Eb as ye,Fa as o,Fb as x,Ga as c,H as de,Ha as fe,I as pe,Ia as ge,Ib as q,K as me,Ma as y,Na as R,O as _,Oa as N,Ob as C,P as ce,Rb as U,Sb as u,T as D,Tb as G,U as O,Ub as L,Vb as Z,Wb as z,Xb as Q,Ya as B,Yb as Y,Zb as Se,_b as M,ac as Ce,bb as $,ca as l,cb as ve,cc as H,da as d,dc as J,eb as he,ec as K,fc as W,j as P,jc as Ie,ka as b,kc as Te,l as se,lc as X,ma as s,nc as Re,qa as a,ra as n,sa as m,vb as k,wa as V,xa as g,xb as be,ya as v,za as A}from"./chunk-25PIQWJN.js";import{a as oe}from"./chunk-P2VZOJAX.js";var T=function(i){return i.MonthlyRent="MonthlyRent",i.PercentageOfSales="PercentageOfSales",i}(T||{});var I=(()=>{class i{http;apiUrl="/api/Tenant";constructor(e){this.http=e}getAllRentals(){return this.http.get(`${this.apiUrl}/FilterTenants`).pipe(P(e=>e.data))}getAllSales(e){return this.http.get(`${this.apiUrl}/FilterTenantSales?TenantId=${e}`).pipe(P(t=>t.data))}createSales(e){return this.http.post(`${this.apiUrl}/AddTenantSales`,e)}createRents(e){return this.http.post(`${this.apiUrl}/AddTenantRend`,e)}getAllRent(e){return this.http.get(`${this.apiUrl}/FilterTenantRent?TenantId=${e}`).pipe(P(t=>t.data))}getRentalById(e){return this.http.get(`${this.apiUrl}/Tenant/${e}`)}getRentalsByBrandId(e){return this.http.get(`${this.apiUrl}/api/Tenant/FilterTenants?brandId=${e}`).pipe(P(t=>t.data))}createRental(e){return this.http.post(`${this.apiUrl}/CreateTenant`,e)}updateRental(e,t){return this.http.put(`${this.apiUrl}/api/Tenant/${e}`,t)}deleteRental(e){return this.http.delete(`${this.apiUrl}/api/Tenant/${e}`)}uploadContractFile(e,t){let r=new FormData;return r.append("file",t),this.http.post(`${this.apiUrl}/api/Tenant/${e}/UploadContract`,r)}static \u0275fac=function(t){return new(t||i)(me(he))};static \u0275prov=de({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function Be(i,f){i&1&&(a(0,"div",3)(1,"label"),o(2,"Rent Value *"),n(),m(3,"p-inputNumber",18),n()),i&2&&(l(3),s("min",0)("showButtons",!0))}function je(i,f){i&1&&(a(0,"div",3)(1,"label"),o(2,"Percentage Value (%) *"),n(),m(3,"p-inputNumber",19),a(4,"label"),o(5,"Annual Sales *"),n(),m(6,"p-inputNumber",20),n()),i&2&&(l(3),s("min",0)("max",100)("showButtons",!0),l(3),s("min",0)("showButtons",!0))}var le=(()=>{class i{fb;ref;config;rentalService;brandService;activityService;messageService;i18n;rentalForm;brands=[];activities=[];isEditMode=!1;expectedAnnualIncome=0;rentTypeOptions=[{label:"Fixed",value:1},{label:"Percentage",value:2}];salesCollectOptions=[{label:"Monthly",value:1},{label:"Quarterly",value:2},{label:"Bi-Annual",value:3},{label:"Annual",value:4}];rentCollectOptions=[{label:"Monthly",value:1},{label:"Quarterly",value:2},{label:"Bi-Annual",value:3},{label:"Annual",value:4}];rentalTypeOptions=[{label:"Monthly Rent",value:T.MonthlyRent},{label:"Percentage of Annual Sales",value:T.PercentageOfSales}];constructor(e,t,r,p,h,E,w,Fe){this.fb=e,this.ref=t,this.config=r,this.rentalService=p,this.brandService=h,this.activityService=E,this.messageService=w,this.i18n=Fe}ngOnInit(){let e=this.config.data?.rental;this.isEditMode=!!e,this.loadBrands(),this.rentalForm=this.fb.group({name:[e?.name||"",u.required],unitNumber:[e?.unitNumber||"",u.required],description:[e?.description||""],rentValue:[e?.rentValue||null,u.required],rentType:[e?.rentType||1,u.required],activityId:[e?.activityId||"",u.required],brandId:[e?.brandId||"",u.required],salesCollectType:[e?.salesCollectType||1,u.required],rentCollectType:[e?.rentCollectType||1,u.required],location:[e?.location||"",u.required],contractDuration:[e?.contractDuration||null,u.required],responsiblePerson:[e?.responsiblePerson||"",u.required]}),this.updateValidators(),this.calculateExpectedIncome(),this.rentalForm.valueChanges.subscribe(()=>{this.calculateExpectedIncome()})}loadBrands(){this.brandService.getAllBrands().subscribe({next:e=>{this.brands=e}})}loadActivities(){this.activityService.getAllActivities().subscribe({next:e=>{this.activities=e.data}})}onRentalTypeChange(){this.updateValidators(),this.calculateExpectedIncome()}updateValidators(){this.rentalForm.get("rentalType")?.value===T.MonthlyRent?(this.rentalForm.get("rentalAmount")?.setValidators([u.required]),this.rentalForm.get("percentageValue")?.clearValidators(),this.rentalForm.get("annualSales")?.clearValidators()):(this.rentalForm.get("rentalAmount")?.clearValidators(),this.rentalForm.get("percentageValue")?.setValidators([u.required]),this.rentalForm.get("annualSales")?.setValidators([u.required])),this.rentalForm.get("rentalAmount")?.updateValueAndValidity(),this.rentalForm.get("percentageValue")?.updateValueAndValidity(),this.rentalForm.get("annualSales")?.updateValueAndValidity()}calculateExpectedIncome(){let e=this.rentalForm.value;if(e.rentalType===T.MonthlyRent&&e.rentalAmount&&e.startDate&&e.endDate){let t=this.getMonthsBetween(e.startDate,e.endDate);this.expectedAnnualIncome=e.rentalAmount*t}else e.rentalType===T.PercentageOfSales&&e.percentageValue&&e.annualSales?this.expectedAnnualIncome=e.annualSales*e.percentageValue/100:this.expectedAnnualIncome=0}getMonthsBetween(e,t){let r=new Date(e),p=new Date(t),h=(p.getFullYear()-r.getFullYear())*12+(p.getMonth()-r.getMonth());return Math.max(1,h)}onSubmit(){if(this.rentalForm.valid){let e=oe({},this.rentalForm.value);(this.isEditMode?this.rentalService.updateRental(this.config.data.rental.id,e):this.rentalService.createRental(e)).subscribe({next:r=>{this.messageService.add({severity:"success",summary:"Success",detail:`Rental ${this.isEditMode?"updated":"created"} successfully`}),this.ref.close(r)},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:`Failed to ${this.isEditMode?"update":"create"} rental`})}})}}static \u0275fac=function(t){return new(t||i)(d(Y),d(K),d(J),d(I),d(ee),d(Me),d(x),d(S))};static \u0275cmp=_({type:i,selectors:[["app-rental-dialog"]],decls:59,vars:14,consts:[[1,"rental-dialog",3,"dir"],[1,"rental-form",3,"ngSubmit","formGroup"],[1,"form-grid-two"],[1,"form-field"],["type","text","pInputText","","formControlName","name",1,"w-full"],["type","text","pInputText","","formControlName","unitNumber",1,"w-full"],["pInputTextarea","","formControlName","description",1,"w-full",3,"rows"],["formControlName","brandId","optionLabel","name","optionValue","id",1,"w-full",3,"options"],["type","text","pInputText","","formControlName","location",1,"w-full"],["type","text","pInputText","","formControlName","responsiblePerson",1,"w-full"],["formControlName","contractDuration",1,"w-full",3,"min","showButtons"],["class","form-field",4,"ngIf"],["formControlName","rentType","optionLabel","label","optionValue","value",1,"w-full",3,"options"],["formControlName","salesCollectType","optionLabel","label","optionValue","value",1,"w-full",3,"options"],["formControlName","rentCollectType","optionLabel","label","optionValue","value",1,"w-full",3,"options"],[1,"form-actions"],["pButton","","type","button","label","Cancel",1,"p-button-secondary",3,"click"],["pButton","","type","submit","label","Save",3,"disabled"],["formControlName","rentValue",1,"w-full",3,"min","showButtons"],["formControlName","percentageValue",1,"w-full",3,"min","max","showButtons"],["formControlName","annualSales","prefix","$",1,"w-full",3,"min","showButtons"]],template:function(t,r){if(t&1&&(a(0,"div",0)(1,"h3"),o(2),n(),a(3,"form",1),g("ngSubmit",function(){return r.onSubmit()}),a(4,"div",2)(5,"div",3)(6,"label"),o(7,"Name *"),n(),m(8,"input",4),n(),a(9,"div",3)(10,"label"),o(11,"Unit Number *"),n(),m(12,"input",5),n()(),a(13,"div",3)(14,"label"),o(15,"Description"),n(),m(16,"textarea",6),n(),a(17,"div",2)(18,"div",3)(19,"label"),o(20,"Brand *"),n(),m(21,"p-dropdown",7),n(),a(22,"div",3)(23,"label"),o(24,"Activity *"),n(),m(25,"p-dropdown",7),n()(),a(26,"div",2)(27,"div",3)(28,"label"),o(29,"Location *"),n(),m(30,"input",8),n(),a(31,"div",3)(32,"label"),o(33,"Responsible Person *"),n(),m(34,"input",9),n()(),a(35,"div",2)(36,"div",3)(37,"label"),o(38,"Contract Duration (months) *"),n(),m(39,"p-inputNumber",10),n(),b(40,Be,4,2,"div",11),n(),a(41,"div",2)(42,"div",3)(43,"label"),o(44,"Rent Type *"),n(),m(45,"p-dropdown",12),n(),b(46,je,7,5,"div",11),n(),a(47,"div",2)(48,"div",3)(49,"label"),o(50,"Sales Collect Type *"),n(),m(51,"p-dropdown",13),n(),a(52,"div",3)(53,"label"),o(54,"Rent Collect Type *"),n(),m(55,"p-dropdown",14),n()(),a(56,"div",15)(57,"button",16),g("click",function(){return r.ref.close()}),n(),m(58,"button",17),n()()()),t&2){let p,h;s("dir",r.i18n.getCurrentLanguage()==="ar"?"rtl":"ltr"),l(2),c(r.isEditMode?r.i18n.translate("rentals.edit"):r.i18n.translate("rentals.add")),l(),s("formGroup",r.rentalForm),l(13),s("rows",4),l(5),s("options",r.brands),l(4),s("options",r.brands),l(14),s("min",1)("showButtons",!0),l(),s("ngIf",((p=r.rentalForm.get("rentType"))==null?null:p.value)===1),l(5),s("options",r.rentTypeOptions),l(),s("ngIf",((h=r.rentalForm.get("rentType"))==null?null:h.value)===2),l(5),s("options",r.salesCollectOptions),l(4),s("options",r.rentCollectOptions),l(3),s("disabled",r.rentalForm.invalid)}},dependencies:[B,Z,U,G,L,z,Q,C,M,xe,Ce,Ie],styles:[".form-grid-two[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem}@media (max-width: 768px){.form-grid-two[_ngcontent-%COMP%]{grid-template-columns:1fr}}.rental-dialog[_ngcontent-%COMP%]{padding:1.5rem;min-width:600px}.rental-dialog[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1.5rem;font-size:1.5rem;font-weight:600}.rental-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}.form-field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-field.full-width[_ngcontent-%COMP%]{grid-column:1 / -1}.form-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#333}.income-display[_ngcontent-%COMP%]{padding:1rem;background:#f0f9ff;border-radius:4px;border-left:4px solid #3b82f6}[dir=rtl][_ngcontent-%COMP%]   .income-display[_ngcontent-%COMP%]{border-left:none;border-right:4px solid #3b82f6}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.5rem;margin-top:1rem;padding-top:1rem;border-top:1px solid #e0e0e0}.w-full[_ngcontent-%COMP%]{width:100%}[dir=rtl][_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{justify-content:flex-start}[dir=rtl][_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{text-align:right}@media (max-width: 768px){.rental-dialog[_ngcontent-%COMP%]{min-width:auto;width:100%}.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})}return i})();var qe=()=>["brandName","rentalType"];function Ue(i,f){if(i&1){let e=V();a(0,"button",9),g("click",function(){D(e);let r=v();return O(r.openAddDialog())}),n()}if(i&2){let e=v();A("label",e.i18n.translate("rentals.add"))}}function Ge(i,f){if(i&1){let e=V();a(0,"div",10)(1,"span",11),m(2,"i",12),a(3,"input",13),g("input",function(r){D(e),v();let p=ue(8);return O(p.filterGlobal(r.target.value,"contains"))}),n()()()}if(i&2){let e=v();l(3),s("placeholder",e.i18n.translate("common.search"))}}function Le(i,f){if(i&1&&(a(0,"th"),o(1),n()),i&2){let e=v(2);l(),c(e.i18n.translate("common.edit"))}}function Ze(i,f){if(i&1&&(a(0,"th"),o(1),n()),i&2){let e=v(2);l(),c(e.i18n.translate("common.delete"))}}function ze(i,f){if(i&1&&(a(0,"tr")(1,"th"),o(2),n(),a(3,"th"),o(4),n(),a(5,"th"),o(6),n(),a(7,"th"),o(8),n(),a(9,"th"),o(10),n(),a(11,"th"),o(12),n(),b(13,Le,2,1,"th",14)(14,Ze,2,1,"th",14),n()),i&2){let e=v();l(2),c(e.i18n.translate("rentals.brand")),l(2),c(e.i18n.translate("rentals.unitNumber")),l(2),c(e.i18n.translate("rentals.rentalType")),l(2),c(e.i18n.translate("rentals.rentalAmount")),l(2),c(e.i18n.translate("rentals.startDate")),l(2),c(e.i18n.translate("rentals.expectedAnnualIncome")),l(),s("ngIf",e.canEdit()),l(),s("ngIf",e.canDelete())}}function Qe(i,f){if(i&1){let e=V();a(0,"td")(1,"button",16),g("click",function(){D(e);let r=v().$implicit,p=v();return O(p.navigateToSaleRent(r))}),n()()}}function Ye(i,f){if(i&1){let e=V();a(0,"td")(1,"button",17),g("click",function(){D(e);let r=v().$implicit,p=v();return O(p.deleteRental(r))}),n()()}}function He(i,f){if(i&1&&(a(0,"tr")(1,"td"),o(2),n(),a(3,"td"),o(4),n(),a(5,"td"),m(6,"p-tag",15),n(),a(7,"td"),o(8),y(9,"currency"),n(),a(10,"td"),o(11),y(12,"date"),n(),a(13,"td"),o(14),y(15,"currency"),n(),b(16,Qe,2,0,"td",14)(17,Ye,2,0,"td",14),n()),i&2){let e=f.$implicit,t=v();l(2),c(e.name),l(2),c(e.unitNumber),l(2),s("value",e.rentType==="Fixed"?"Monthly Rent":"Percentage")("severity",e.rentType==="MonthlyRent"?"info":"success"),l(2),fe(" ",e.rentValue?R(9,9,e.rentValue):e.percentageValue+"%"," "),l(3),c(N(12,11,e.createdOn,"shortDate")),l(3),c(R(15,14,e.expectedAnnualIncome)),l(2),s("ngIf",t.canEdit()),l(),s("ngIf",t.canDelete())}}var De=(()=>{class i{rentalService;brandService;messageService;confirmationService;dialogService;i18n;router;rentals=[];loading=!1;ref;constructor(e,t,r,p,h,E,w){this.rentalService=e,this.brandService=t,this.messageService=r,this.confirmationService=p,this.dialogService=h,this.i18n=E,this.router=w}ngOnInit(){this.loadRentals()}loadRentals(){this.loading=!0,this.rentalService.getAllRentals().subscribe({next:e=>{this.rentals=e.map(t=>({id:t.id,name:t.name??t.brand?.name??"",description:t.description??t.activity?.name??"",unitNumber:t.unitNumber??"",imageUrl:t.imageUrl??null,rentValue:t.rentValue,rentalAmount:t.rentValue,rentType:t.rentType,salesCollectType:t.salesCollectType??"",rentCollectType:t.rentCollectType??"",activityId:t.activityId??"",activity:t.activity??void 0,brandId:t.brandId??"",brand:t.brand??void 0,parentTenantId:t.parentTenantId??null,createdOn:new Date(t.createdOn),startDate:new Date(t.createdOn),expectedAnnualIncome:t.rentValue??0,contractDuration:t.contractDuration??void 0,responsiblePerson:t.responsiblePerson??void 0,location:t.location??void 0,annualSales:t.annualSales??void 0,percentageValue:t.percentageValue??void 0,expectedRevenue:t.expectedRevenue??0})),this.loading=!1},error:()=>{this.loading=!1,this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load rentals"})}})}navigateToSaleRent(e){let t=e?.tenantId||e?.id||e?.tenantID;if(!t){console.error("No tenant ID found in rental object",e);return}this.router.navigate(["/rentals/sale-rant",t])}openAddDialog(){this.ref=this.dialogService.open(le,{header:this.i18n.translate("rentals.add"),width:"70%",contentStyle:{"max-height":"90vh",overflow:"auto"},baseZIndex:1e4,data:{rental:null}}),this.ref.onClose.subscribe(e=>{e&&this.loadRentals()})}openEditDialog(e){this.ref=this.dialogService.open(le,{header:this.i18n.translate("rentals.edit"),width:"70%",contentStyle:{"max-height":"90vh",overflow:"auto"},baseZIndex:1e4,data:{rental:e}}),this.ref.onClose.subscribe(t=>{t&&this.loadRentals()})}deleteRental(e){this.confirmationService.confirm({message:"Are you sure you want to delete this rental?",header:"Confirm Delete",icon:"pi pi-exclamation-triangle",accept:()=>{this.rentalService.deleteRental(e.id).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Success",detail:"Rental deleted successfully"}),this.loadRentals()},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to delete rental"})}})}})}canEdit(){return!0}canDelete(){return!0}static \u0275fac=function(t){return new(t||i)(d(I),d(ee),d(x),d(ye),d(W),d(S),d(be))};static \u0275cmp=_({type:i,selectors:[["app-rentals"]],decls:12,vars:8,consts:[["dt",""],[1,"rentals-container"],[1,"p-toolbar-group-start"],[1,"p-toolbar-group-end"],["pButton","","icon","pi pi-plus",3,"label","click",4,"ngIf"],["styleClass","p-datatable-striped",3,"value","paginator","rows","globalFilterFields","loading"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pButton","","icon","pi pi-plus",3,"click","label"],[1,"table-header"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text",3,"input","placeholder"],[4,"ngIf"],[3,"value","severity"],["pButton","","icon","pi pi-pencil",1,"p-button-rounded","p-button-text",3,"click"],["pButton","","icon","pi pi-trash",1,"p-button-rounded","p-button-text","p-button-danger",3,"click"]],template:function(t,r){t&1&&(a(0,"div",1)(1,"p-toolbar")(2,"div",2)(3,"h2"),o(4),n()(),a(5,"div",3),b(6,Ue,1,1,"button",4),n()(),a(7,"p-table",5,0),b(9,Ge,4,1,"ng-template",6)(10,ze,15,8,"ng-template",7)(11,He,18,16,"ng-template",8),n()()),t&2&&(l(4),c(r.i18n.translate("rentals.title")),l(2),s("ngIf",r.canEdit()),l(),s("value",r.rentals)("paginator",!0)("rows",10)("globalFilterFields",ge(7,qe))("loading",r.loading))},dependencies:[B,C,q,M,H,Te,X,$,j],styles:[".rentals-container[_ngcontent-%COMP%], [dir=rtl][_ngcontent-%COMP%]   .rentals-container[_ngcontent-%COMP%], [dir=ltr][_ngcontent-%COMP%]   .rentals-container[_ngcontent-%COMP%]{padding:2rem}.table-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}[dir=rtl][_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]{flex-direction:row-reverse}"]})}return i})();var Oe=(()=>{class i{fb;ref;config;rentalService;activatedRoute;messageService;i18n;saleRentForm;isEditMode=!1;expectedAnnualIncome=0;TenantId;constructor(e,t,r,p,h,E,w){this.fb=e,this.ref=t,this.config=r,this.rentalService=p,this.activatedRoute=h,this.messageService=E,this.i18n=w}ngOnInit(){this.TenantId=this.config.data?.rental,console.log("Dialog TenantId = ",this.TenantId),this.saleRentForm=this.fb.group({salesValue:["",u.required],rentValue:["",u.required],period:["",u.required]})}onSubmit(){if(!this.saleRentForm.valid||!this.TenantId)return;let e=this.saleRentForm.value,t={rentValue:e.rentValue,period:e.period,tenantId:this.TenantId},r={salesValue:e.salesValue,period:e.period,tenantId:this.TenantId};se({rent:this.rentalService.createRents(t),sales:this.rentalService.createSales(r)}).subscribe({next:p=>{this.messageService.add({severity:"success",summary:"Success",detail:"Sales & Rent created successfully"}),this.ref.close(p)},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to create rent or sales"})}})}static \u0275fac=function(t){return new(t||i)(d(Y),d(K),d(J),d(I),d(k),d(x),d(S))};static \u0275cmp=_({type:i,selectors:[["app-sale-rent-dialog"]],decls:20,vars:4,consts:[[1,"rental-dialog",3,"dir"],[1,"rental-form",3,"ngSubmit","formGroup"],[1,"form-grid-two"],[1,"form-field"],["type","text","pInputText","","formControlName","salesValue",1,"w-full"],["type","text","pInputText","","formControlName","rentValue",1,"w-full"],["type","text","pInputText","","formControlName","period",1,"w-full"],[1,"form-actions"],["pButton","","type","button","label","Cancel",1,"p-button-secondary",3,"click"],["pButton","","type","submit","label","Save",3,"disabled"]],template:function(t,r){t&1&&(a(0,"div",0)(1,"h3"),o(2),n(),a(3,"form",1),g("ngSubmit",function(){return r.onSubmit()}),a(4,"div",2)(5,"div",3)(6,"label"),o(7,"Sales Value *"),n(),m(8,"input",4),n(),a(9,"div",3)(10,"label"),o(11,"Rent Value *"),n(),m(12,"input",5),n()(),a(13,"div",3)(14,"label"),o(15,"period*"),n(),m(16,"input",6),n(),a(17,"div",7)(18,"button",8),g("click",function(){return r.ref.close()}),n(),m(19,"button",9),n()()()),t&2&&(s("dir",r.i18n.getCurrentLanguage()==="ar"?"rtl":"ltr"),l(2),c(r.isEditMode?r.i18n.translate("rentals.edit"):r.i18n.translate("rentals.sale")),l(),s("formGroup",r.saleRentForm),l(16),s("disabled",r.saleRentForm.invalid))},dependencies:[Z,U,G,L,z,Q,C,M],styles:[".form-grid-two[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem}@media (max-width: 768px){.form-grid-two[_ngcontent-%COMP%]{grid-template-columns:1fr}}.rental-dialog[_ngcontent-%COMP%]{padding:1.5rem;min-width:600px}.rental-dialog[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1.5rem;font-size:1.5rem;font-weight:600}.rental-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}.form-field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-field.full-width[_ngcontent-%COMP%]{grid-column:1 / -1}.form-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#333}.income-display[_ngcontent-%COMP%]{padding:1rem;background:#f0f9ff;border-radius:4px;border-left:4px solid #3b82f6}[dir=rtl][_ngcontent-%COMP%]   .income-display[_ngcontent-%COMP%]{border-left:none;border-right:4px solid #3b82f6}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.5rem;margin-top:1rem;padding-top:1rem;border-top:1px solid #e0e0e0}.w-full[_ngcontent-%COMP%]{width:100%}[dir=rtl][_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{justify-content:flex-start}[dir=rtl][_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{text-align:right}@media (max-width: 768px){.rental-dialog[_ngcontent-%COMP%]{min-width:auto;width:100%}.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})}return i})();function Je(i,f){i&1&&(a(0,"tr")(1,"th"),o(2,"Period"),n(),a(3,"th"),o(4,"Rent Value"),n()())}function Ke(i,f){if(i&1&&(a(0,"tr")(1,"td"),o(2),y(3,"date"),n(),a(4,"td"),o(5),y(6,"currency"),n()()),i&2){let e=f.$implicit;l(2),c(N(3,2,e.period,"MMMM yyyy")),l(3),c(R(6,5,e.rentValue))}}function We(i,f){i&1&&(a(0,"tr")(1,"th"),o(2,"Label"),n(),a(3,"th"),o(4,"Sales Value"),n()())}function Xe(i,f){if(i&1&&(a(0,"tr")(1,"td"),o(2),n(),a(3,"td"),o(4),y(5,"currency"),n()()),i&2){let e=f.$implicit;l(2),c(e.label),l(2),c(R(5,2,e.salesValue))}}var Ve=(()=>{class i{rentalService;activatedRoute;messageService;i18n;dialogService;Rent=[];Sales=[];TenantId;loading=!1;ref;constructor(e,t,r,p,h){this.rentalService=e,this.activatedRoute=t,this.messageService=r,this.i18n=p,this.dialogService=h}ngOnInit(){this.TenantId=this.activatedRoute.snapshot.paramMap.get("tenantId"),console.log("TenantId:",this.TenantId),this.loadRent(),this.loadSales()}loadRent(){this.loading=!0,this.rentalService.getAllRent(this.TenantId).subscribe({next:e=>{this.Rent=e?.years?.[0]?.rentTypes?.[0]?.items||[],console.log("Rent items:",this.Rent),this.loading=!1},error:()=>{this.loading=!1,this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load rent data"})}})}loadSales(){this.loading=!0,this.rentalService.getAllSales(this.TenantId).subscribe({next:e=>{this.Sales=e?.years?.[0]?.salesTypes?.[0]?.items||[],console.log("Sales items:",this.Sales),this.loading=!1},error:()=>{this.loading=!1,this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load sales data"})}})}openAddDialog(){this.ref=this.dialogService.open(Oe,{header:this.i18n.translate("rentals.sale"),width:"70%",contentStyle:{"max-height":"90vh",overflow:"auto"},baseZIndex:1e4,data:{rental:this.TenantId}}),this.ref.onClose.subscribe(e=>{e&&(this.loadSales(),this.loadRent())})}static \u0275fac=function(t){return new(t||i)(d(I),d(k),d(x),d(S),d(W))};static \u0275cmp=_({type:i,selectors:[["app-sale-rent"]],decls:20,vars:4,consts:[[1,"rentals-container"],[1,"p-toolbar-group-start"],[1,"p-toolbar-group-end"],["pButton","","icon","pi pi-plus",3,"click","label"],[1,"tables-wrapper"],[1,"table-box"],["styleClass","p-datatable-gridlines",3,"value"],["pTemplate","header"],["pTemplate","body"]],template:function(t,r){t&1&&(a(0,"div",0)(1,"p-toolbar")(2,"div",1)(3,"h2"),o(4),n()(),a(5,"div",2)(6,"button",3),g("click",function(){return r.openAddDialog()}),n()()(),a(7,"div",4)(8,"div",5)(9,"h3"),o(10,"Rent Details"),n(),a(11,"p-table",6),b(12,Je,5,0,"ng-template",7)(13,Ke,7,7,"ng-template",8),n()(),a(14,"div",5)(15,"h3"),o(16,"Sales Details"),n(),a(17,"p-table",6),b(18,We,5,0,"ng-template",7)(19,Xe,6,4,"ng-template",8),n()()()()),t&2&&(l(4),c(r.i18n.translate("rentals.title")),l(2),A("label",r.i18n.translate("rentals.sale")),l(5),s("value",r.Rent),l(6),s("value",r.Sales))},dependencies:[C,q,H,X,$,j],styles:[".rentals-container[_ngcontent-%COMP%], [dir=rtl][_ngcontent-%COMP%]   .rentals-container[_ngcontent-%COMP%], [dir=ltr][_ngcontent-%COMP%]   .rentals-container[_ngcontent-%COMP%]{padding:2rem}.table-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}[dir=rtl][_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]{flex-direction:row-reverse}"]})}return i})();var wt=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=ce({type:i});static \u0275inj=pe({imports:[ve,Se,Re,_e.forChild([{path:"",component:De},{path:"sale-rant/:tenantId",component:Ve}])]})}return i})();export{wt as RentalsModule};
