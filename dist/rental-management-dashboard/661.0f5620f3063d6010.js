"use strict";(self.webpackChunkrental_management_dashboard=self.webpackChunkrental_management_dashboard||[]).push([[661],{4661:(J,u,s)=>{s.r(u),s.d(u,{ActivitiesModule:()=>N});var m=s(177),l=s(9417),F=s(4008),b=s(7436),t=s(4438),v=s(2100),g=s(2633),p=s(5779),f=s(3422),h=s(1141),y=s(2242),C=s(1802),A=s(675),R=s(1305);function E(e,r){if(1&e&&(t.j41(0,"small",14),t.EFF(1),t.k0s()),2&e){const i=t.XpG();t.R7$(),t.SpI(" ",i.i18n.translate("activities.name")," is required ")}}function S(e,r){if(1&e&&(t.j41(0,"small",14),t.EFF(1),t.k0s()),2&e){const i=t.XpG();t.R7$(),t.SpI(" ",i.i18n.translate("activities.description")," is required ")}}function $(e,r){if(1&e&&(t.j41(0,"small",14),t.EFF(1),t.k0s()),2&e){const i=t.XpG();t.R7$(),t.SpI(" ",i.i18n.translate("activities.safeValue")," is required ")}}let _=(()=>{class e{fb;ref;config;activityService;messageService;i18n;activityForm;parentActivities=[];isEditMode=!1;saving=!1;constructor(i,a,n,o,c,d){this.fb=i,this.ref=a,this.config=n,this.activityService=o,this.messageService=c,this.i18n=d}ngOnInit(){const i=this.config.data?.activity;this.isEditMode=!!i,this.loadParentActivities(),this.activityForm=this.fb.group({name:[i?.name||"",l.k0.required],description:[i?.description||"",l.k0.required],safeValue:[i?.safeValue||0,[l.k0.required,l.k0.min(0),l.k0.max(100)]],parentActivityId:[i?.parentActivityId||null]})}loadParentActivities(){this.activityService.getAllActivities().subscribe({next:i=>{if(i.status&&i.data){const a=this.config.data?.activity?.id;this.parentActivities=i.data.filter(n=>n.id!==a)}},error:i=>{console.error("Error loading parent activities:",i),this.messageService.add({severity:"warn",summary:"Warning",detail:"Failed to load parent activities"})}})}onSubmit(){if(this.activityForm.valid){this.saving=!0;const i={name:this.activityForm.value.name,description:this.activityForm.value.description,safeValue:this.activityForm.value.safeValue,parentActivityId:this.activityForm.value.parentActivityId||null};(this.isEditMode?this.activityService.updateActivity(this.config.data.activity.id,i):this.activityService.createActivity(i)).subscribe({next:n=>{const o=n.data||n;this.messageService.add({severity:"success",summary:"Success",detail:`Activity ${this.isEditMode?"updated":"created"} successfully`}),this.saving=!1,this.ref.close(o)},error:n=>{this.saving=!1,this.messageService.add({severity:"error",summary:"Error",detail:n.error?.message||`Failed to ${this.isEditMode?"update":"create"} activity`}),console.error("Error saving activity:",n)}})}}static \u0275fac=function(a){return new(a||e)(t.rXU(l.ok),t.rXU(v.Pw),t.rXU(v.sb),t.rXU(g.T),t.rXU(p.bg),t.rXU(f.W))};static \u0275cmp=t.VBU({type:e,selectors:[["app-activity-dialog"]],decls:29,vars:27,consts:[[1,"activity-dialog",3,"dir"],[1,"activity-form",3,"ngSubmit","formGroup"],[1,"form-grid"],[1,"form-field","full-width"],["pInputText","","formControlName","name",1,"w-full",3,"placeholder"],["class","p-error",4,"ngIf"],["pInputTextarea","","formControlName","description",1,"w-full",3,"rows","placeholder"],[1,"form-field"],["formControlName","safeValue","suffix","%",1,"w-full",3,"min","max","minFractionDigits","maxFractionDigits","showButtons"],["formControlName","parentActivityId","optionLabel","name","optionValue","id","filterBy","name",1,"w-full",3,"options","placeholder","showClear","filter"],[1,"form-hint"],[1,"form-actions"],["pButton","","type","button",1,"p-button-secondary",3,"click","label"],["pButton","","type","submit",3,"label","disabled","loading"],[1,"p-error"]],template:function(a,n){if(1&a&&(t.j41(0,"div",0)(1,"h3"),t.EFF(2),t.k0s(),t.j41(3,"form",1),t.bIt("ngSubmit",function(){return n.onSubmit()}),t.j41(4,"div",2)(5,"div",3)(6,"label"),t.EFF(7),t.k0s(),t.nrm(8,"input",4),t.DNE(9,E,2,1,"small",5),t.k0s(),t.j41(10,"div",3)(11,"label"),t.EFF(12),t.k0s(),t.nrm(13,"textarea",6),t.DNE(14,S,2,1,"small",5),t.k0s(),t.j41(15,"div",7)(16,"label"),t.EFF(17),t.k0s(),t.nrm(18,"p-inputNumber",8),t.DNE(19,$,2,1,"small",5),t.k0s(),t.j41(20,"div",7)(21,"label"),t.EFF(22),t.k0s(),t.nrm(23,"p-dropdown",9),t.j41(24,"small",10),t.EFF(25),t.k0s()()(),t.j41(26,"div",11)(27,"button",12),t.bIt("click",function(){return n.ref.close()}),t.k0s(),t.nrm(28,"button",13),t.k0s()()()),2&a){let o,c,d;t.Y8G("dir","ar"===n.i18n.getCurrentLanguage()?"rtl":"ltr"),t.R7$(2),t.JRh(n.i18n.translate(n.isEditMode?"activities.edit":"activities.add")),t.R7$(),t.Y8G("formGroup",n.activityForm),t.R7$(4),t.SpI("",n.i18n.translate("activities.name")," *"),t.R7$(),t.Y8G("placeholder",n.i18n.translate("activities.name")),t.R7$(),t.Y8G("ngIf",(null==(o=n.activityForm.get("name"))?null:o.hasError("required"))&&(null==(o=n.activityForm.get("name"))?null:o.touched)),t.R7$(3),t.SpI("",n.i18n.translate("activities.description")," *"),t.R7$(),t.Y8G("rows",4)("placeholder",n.i18n.translate("activities.description")),t.R7$(),t.Y8G("ngIf",(null==(c=n.activityForm.get("description"))?null:c.hasError("required"))&&(null==(c=n.activityForm.get("description"))?null:c.touched)),t.R7$(3),t.SpI("",n.i18n.translate("activities.safeValue")," *"),t.R7$(),t.Y8G("min",0)("max",100)("minFractionDigits",2)("maxFractionDigits",2)("showButtons",!0),t.R7$(),t.Y8G("ngIf",(null==(d=n.activityForm.get("safeValue"))?null:d.hasError("required"))&&(null==(d=n.activityForm.get("safeValue"))?null:d.touched)),t.R7$(3),t.JRh(n.i18n.translate("activities.parentActivity")),t.R7$(),t.Y8G("options",n.parentActivities)("placeholder",n.i18n.translate("activities.selectParent"))("showClear",!0)("filter",!0),t.R7$(2),t.JRh(n.i18n.translate("activities.parentActivityHint")),t.R7$(2),t.FS9("label",n.i18n.translate("common.cancel")),t.R7$(),t.FS9("label",n.i18n.translate("common.save")),t.Y8G("disabled",n.activityForm.invalid||n.saving)("loading",n.saving)}},dependencies:[m.bT,l.qT,l.me,l.BC,l.cb,l.j4,l.JD,h._f,y.S,C.YI,A.ms,R.Z],styles:[".activity-dialog[_ngcontent-%COMP%]{padding:1.5rem;min-width:600px}.activity-dialog[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1.5rem;font-size:1.5rem;font-weight:600}.activity-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}.form-field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-field.full-width[_ngcontent-%COMP%]{grid-column:1 / -1}.form-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#333}.form-hint[_ngcontent-%COMP%]{color:#666;font-size:.85rem;font-style:italic}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.5rem;margin-top:1rem;padding-top:1rem;border-top:1px solid #e0e0e0}.w-full[_ngcontent-%COMP%]{width:100%}[dir=rtl][_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{justify-content:flex-start}[dir=rtl][_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{text-align:right}@media (max-width: 768px){.activity-dialog[_ngcontent-%COMP%]{min-width:auto;width:100%}.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})}return e})();var I=s(9245),j=s(1830);const k=()=>["name","description"];function G(e,r){if(1&e){const i=t.RV6();t.j41(0,"button",10),t.bIt("click",function(){t.eBV(i);const n=t.XpG();return t.Njj(n.openAddDialog())}),t.k0s()}if(2&e){const i=t.XpG();t.FS9("label",i.i18n.translate("activities.add"))}}function x(e,r){if(1&e){const i=t.RV6();t.j41(0,"div",11)(1,"span",12),t.nrm(2,"i",13),t.j41(3,"input",14),t.bIt("input",function(n){t.eBV(i),t.XpG();const o=t.sdS(8);return t.Njj(o.filterGlobal(n.target.value,"contains"))}),t.k0s()()()}if(2&e){const i=t.XpG();t.R7$(3),t.Y8G("placeholder",i.i18n.translate("common.search"))}}function M(e,r){if(1&e&&(t.j41(0,"th"),t.EFF(1),t.k0s()),2&e){const i=t.XpG(2);t.R7$(),t.JRh(i.i18n.translate("common.edit"))}}function P(e,r){if(1&e&&(t.j41(0,"th"),t.EFF(1),t.k0s()),2&e){const i=t.XpG(2);t.R7$(),t.JRh(i.i18n.translate("common.delete"))}}function T(e,r){if(1&e&&(t.j41(0,"tr")(1,"th"),t.EFF(2),t.k0s(),t.j41(3,"th"),t.EFF(4),t.k0s(),t.j41(5,"th"),t.EFF(6),t.k0s(),t.j41(7,"th"),t.EFF(8),t.k0s(),t.DNE(9,M,2,1,"th",15)(10,P,2,1,"th",15),t.k0s()),2&e){const i=t.XpG();t.R7$(2),t.JRh(i.i18n.translate("activities.name")),t.R7$(2),t.JRh(i.i18n.translate("activities.description")),t.R7$(2),t.JRh(i.i18n.translate("activities.safeValue")),t.R7$(2),t.JRh(i.i18n.translate("activities.parentActivity")),t.R7$(),t.Y8G("ngIf",i.canEdit()),t.R7$(),t.Y8G("ngIf",i.canDelete())}}function D(e,r){if(1&e&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&e){const i=t.XpG().$implicit;t.R7$(),t.JRh(i.parentActivity.name)}}function X(e,r){1&e&&(t.j41(0,"span",17),t.EFF(1,"-"),t.k0s())}function O(e,r){if(1&e){const i=t.RV6();t.j41(0,"td")(1,"button",18),t.bIt("click",function(){t.eBV(i);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.openEditDialog(n))}),t.k0s()()}}function w(e,r){if(1&e){const i=t.RV6();t.j41(0,"td")(1,"button",19),t.bIt("click",function(){t.eBV(i);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.deleteActivity(n))}),t.k0s()()}}function V(e,r){if(1&e&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.nI1(7,"number"),t.k0s(),t.j41(8,"td"),t.DNE(9,D,2,1,"span",15)(10,X,2,0,"span",16),t.k0s(),t.DNE(11,O,2,0,"td",15)(12,w,2,0,"td",15),t.k0s()),2&e){const i=r.$implicit,a=t.XpG();t.R7$(2),t.JRh(i.name),t.R7$(2),t.JRh(i.description),t.R7$(2),t.SpI("",t.i5U(7,7,i.safeValue,"1.2-2"),"%"),t.R7$(3),t.Y8G("ngIf",i.parentActivity),t.R7$(),t.Y8G("ngIf",!i.parentActivity),t.R7$(),t.Y8G("ngIf",a.canEdit()),t.R7$(),t.Y8G("ngIf",a.canDelete())}}function Y(e,r){if(1&e&&(t.j41(0,"tr")(1,"td",20),t.EFF(2),t.k0s()()),2&e){const i=t.XpG();t.R7$(),t.BMQ("colspan",i.canEdit()?6:4),t.R7$(),t.SpI(" ",i.i18n.translate("common.noData")," ")}}let B=(()=>{class e{activityService;messageService;confirmationService;dialogService;i18n;activities=[];loading=!1;ref;constructor(i,a,n,o,c){this.activityService=i,this.messageService=a,this.confirmationService=n,this.dialogService=o,this.i18n=c}ngOnInit(){this.loadActivities()}loadActivities(){this.loading=!0,this.activityService.getAllActivities().subscribe({next:i=>{i.status&&i.data?this.activities=i.data:(this.messageService.add({severity:"warn",summary:"Warning",detail:i.message||"Failed to load activities"}),this.activities=[]),this.loading=!1},error:i=>{this.loading=!1,this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load activities. Please check your API connection."}),console.error("Error loading activities:",i)}})}openAddDialog(){this.ref=this.dialogService.open(_,{header:this.i18n.translate("activities.add"),width:"70%",contentStyle:{"max-height":"90vh",overflow:"auto"},baseZIndex:1e4,data:{activity:null}}),this.ref.onClose.subscribe(i=>{i&&this.loadActivities()})}openEditDialog(i){this.ref=this.dialogService.open(_,{header:this.i18n.translate("activities.edit"),width:"70%",contentStyle:{"max-height":"90vh",overflow:"auto"},baseZIndex:1e4,data:{activity:i}}),this.ref.onClose.subscribe(a=>{a&&this.loadActivities()})}deleteActivity(i){this.confirmationService.confirm({message:`Are you sure you want to delete "${i.name}"?`,header:"Confirm Delete",icon:"pi pi-exclamation-triangle",accept:()=>{this.activityService.deleteActivity(i.id).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Success",detail:"Activity deleted successfully"}),this.loadActivities()},error:a=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to delete activity"}),console.error("Error deleting activity:",a)}})}})}canEdit(){return!0}canDelete(){return!0}static \u0275fac=function(a){return new(a||e)(t.rXU(g.T),t.rXU(p.bg),t.rXU(p.td),t.rXU(v.o3),t.rXU(f.W))};static \u0275cmp=t.VBU({type:e,selectors:[["app-activities"]],decls:13,vars:9,consts:[["dt",""],[1,"activities-container"],[1,"p-toolbar-group-start"],[1,"p-toolbar-group-end"],["pButton","","icon","pi pi-plus",3,"label","click",4,"ngIf"],["styleClass","p-datatable-striped",3,"value","paginator","rows","globalFilterFields","loading","rowHover"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pButton","","icon","pi pi-plus",3,"click","label"],[1,"table-header"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text",3,"input","placeholder"],[4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"text-muted"],["pButton","","icon","pi pi-pencil",1,"p-button-rounded","p-button-text",3,"click"],["pButton","","icon","pi pi-trash",1,"p-button-rounded","p-button-text","p-button-danger",3,"click"],[1,"text-center"]],template:function(a,n){1&a&&(t.j41(0,"div",1)(1,"p-toolbar")(2,"div",2)(3,"h2"),t.EFF(4),t.k0s()(),t.j41(5,"div",3),t.DNE(6,G,1,1,"button",4),t.k0s()(),t.j41(7,"p-table",5,0),t.DNE(9,x,4,1,"ng-template",6)(10,T,11,6,"ng-template",7)(11,V,13,10,"ng-template",8)(12,Y,3,2,"ng-template",9),t.k0s()()),2&a&&(t.R7$(4),t.JRh(n.i18n.translate("activities.title")),t.R7$(2),t.Y8G("ngIf",n.canEdit()),t.R7$(),t.Y8G("value",n.activities)("paginator",!0)("rows",10)("globalFilterFields",t.lJ4(8,k))("loading",n.loading)("rowHover",!0))},dependencies:[m.bT,h._f,p.Ei,y.S,I.XI,j.M,m.QX],styles:[".activities-container[_ngcontent-%COMP%], [dir=rtl][_ngcontent-%COMP%]   .activities-container[_ngcontent-%COMP%], [dir=ltr][_ngcontent-%COMP%]   .activities-container[_ngcontent-%COMP%]{padding:2rem}.table-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}[dir=rtl][_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]{flex-direction:row-reverse}.text-muted[_ngcontent-%COMP%]{color:#999;font-style:italic}.text-center[_ngcontent-%COMP%]{text-align:center;padding:2rem}"]})}return e})(),N=(()=>{class e{static \u0275fac=function(a){return new(a||e)};static \u0275mod=t.$C({type:e});static \u0275inj=t.G2t({imports:[m.MD,l.X1,b.G,F.iI.forChild([{path:"",component:B}])]})}return e})()}}]);