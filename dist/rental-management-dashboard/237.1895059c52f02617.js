"use strict";(self.webpackChunkrental_management_dashboard=self.webpackChunkrental_management_dashboard||[]).push([[237],{9237:(ne,F,o)=>{o.r(F),o.d(F,{RentalsModule:()=>ee});var c=o(177),l=o(9417),f=o(4008),I=o(7436),u=function(a){return a.MonthlyRent="MonthlyRent",a.PercentageOfSales="PercentageOfSales",a}(u||{}),e=o(4438),m=o(2100),b=o(6354),M=o(5312),x=o(1626);let v=(()=>{class a{http;apiUrl=`${M.c.apiUrl}/Tenant`;constructor(t){this.http=t}getAllRentals(){return this.http.get(`${this.apiUrl}/FilterTenants`).pipe((0,b.T)(t=>t.data))}getAllSales(t){return this.http.get(`${this.apiUrl}/FilterTenantSales?TenantId=${t}`).pipe((0,b.T)(n=>n.data))}createSales(t){return this.http.post(`${this.apiUrl}/AddTenantSales`,t)}createRents(t){return this.http.post(`${this.apiUrl}/AddTenantRend`,t)}getAllRent(t){return this.http.get(`${this.apiUrl}/FilterTenantRent?TenantId=${t}`).pipe((0,b.T)(n=>n.data))}getRentalById(t){return this.http.get(`${this.apiUrl}/Tenant/${t}`)}getRentalsByBrandId(t){return this.http.get(`${this.apiUrl}/api/Tenant/FilterTenants?brandId=${t}`).pipe((0,b.T)(n=>n.data))}createRental(t){return this.http.post(`${this.apiUrl}/CreateTenant`,t)}updateRental(t,n){return this.http.put(`${this.apiUrl}/api/Tenant/${t}`,n)}deleteRental(t){return this.http.delete(`${this.apiUrl}/api/Tenant/${t}`)}uploadContractFile(t,n){const r=new FormData;return r.append("file",n),this.http.post(`${this.apiUrl}/api/Tenant/${t}/UploadContract`,r)}static \u0275fac=function(n){return new(n||a)(e.KVO(x.Qq))};static \u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var S=o(2953),j=o(2633),p=o(5779),R=o(3422),y=o(1141),C=o(2242),O=o(1802),P=o(675),E=o(1305);function $(a,s){1&a&&(e.j41(0,"div",3)(1,"label"),e.EFF(2,"Rent Value *"),e.k0s(),e.nrm(3,"p-inputNumber",19),e.k0s()),2&a&&(e.R7$(3),e.Y8G("min",0)("showButtons",!0))}function V(a,s){1&a&&(e.j41(0,"div",3)(1,"label"),e.EFF(2,"Percentage Value (%) *"),e.k0s(),e.nrm(3,"p-inputNumber",20),e.j41(4,"label"),e.EFF(5,"Annual Sales *"),e.k0s(),e.nrm(6,"p-inputNumber",21),e.k0s()),2&a&&(e.R7$(3),e.Y8G("min",0)("max",100)("showButtons",!0),e.R7$(3),e.Y8G("min",0)("showButtons",!0))}let T=(()=>{class a{fb;ref;config;rentalService;brandService;activityService;messageService;i18n;rentalForm;brands=[];activities=[];isEditMode=!1;expectedAnnualIncome=0;rentTypeOptions=[{label:"Fixed",value:1},{label:"Percentage",value:2}];salesCollectOptions=[{label:"Monthly",value:1},{label:"Quarterly",value:2},{label:"Bi-Annual",value:3},{label:"Annual",value:4}];rentCollectOptions=[{label:"Monthly",value:1},{label:"Quarterly",value:2},{label:"Bi-Annual",value:3},{label:"Annual",value:4}];rentalTypeOptions=[{label:"Monthly Rent",value:u.MonthlyRent},{label:"Percentage of Annual Sales",value:u.PercentageOfSales}];constructor(t,n,r,i,d,g,h,te){this.fb=t,this.ref=n,this.config=r,this.rentalService=i,this.brandService=d,this.activityService=g,this.messageService=h,this.i18n=te}ngOnInit(){const t=this.config.data?.rental;this.isEditMode=!!t,this.loadBrands(),this.loadActivities(),this.rentalForm=this.fb.group({name:[t?.name||"",l.k0.required],unitNumber:[t?.unitNumber||"",l.k0.required],description:[t?.description||""],rentValue:[t?.rentValue||null,l.k0.required],rentType:[t?.rentType||1,l.k0.required],activityId:[t?.activityId||"",l.k0.required],brandId:[t?.brandId||"",l.k0.required],salesCollectType:[t?.salesCollectType||1,l.k0.required],rentCollectType:[t?.rentCollectType||1,l.k0.required],location:[t?.location||"",l.k0.required],contractDuration:[t?.contractDuration||null,l.k0.required],responsiblePerson:[t?.responsiblePerson||"",l.k0.required]}),this.updateValidators(),this.calculateExpectedIncome(),this.rentalForm.valueChanges.subscribe(()=>{this.calculateExpectedIncome()})}loadBrands(){this.brandService.getAllBrands().subscribe({next:t=>{this.brands=t}})}loadActivities(){this.activityService.getAllActivities().subscribe({next:t=>{this.activities=t.data}})}onRentalTypeChange(){this.updateValidators(),this.calculateExpectedIncome()}updateValidators(){this.rentalForm.get("rentalType")?.value===u.MonthlyRent?(this.rentalForm.get("rentalAmount")?.setValidators([l.k0.required]),this.rentalForm.get("percentageValue")?.clearValidators(),this.rentalForm.get("annualSales")?.clearValidators()):(this.rentalForm.get("rentalAmount")?.clearValidators(),this.rentalForm.get("percentageValue")?.setValidators([l.k0.required]),this.rentalForm.get("annualSales")?.setValidators([l.k0.required])),this.rentalForm.get("rentalAmount")?.updateValueAndValidity(),this.rentalForm.get("percentageValue")?.updateValueAndValidity(),this.rentalForm.get("annualSales")?.updateValueAndValidity()}calculateExpectedIncome(){const t=this.rentalForm.value;if(t.rentalType===u.MonthlyRent&&t.rentalAmount&&t.startDate&&t.endDate){const n=this.getMonthsBetween(t.startDate,t.endDate);this.expectedAnnualIncome=t.rentalAmount*n}else this.expectedAnnualIncome=t.rentalType===u.PercentageOfSales&&t.percentageValue&&t.annualSales?t.annualSales*t.percentageValue/100:0}getMonthsBetween(t,n){const r=new Date(t),i=new Date(n),d=12*(i.getFullYear()-r.getFullYear())+(i.getMonth()-r.getMonth());return Math.max(1,d)}onSubmit(){if(this.rentalForm.valid){const t={...this.rentalForm.value};(this.isEditMode?this.rentalService.updateRental(this.config.data.rental.id,t):this.rentalService.createRental(t)).subscribe({next:r=>{this.messageService.add({severity:"success",summary:"Success",detail:`Rental ${this.isEditMode?"updated":"created"} successfully`}),this.ref.close(r)},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:`Failed to ${this.isEditMode?"update":"create"} rental`})}})}}static \u0275fac=function(n){return new(n||a)(e.rXU(l.ok),e.rXU(m.Pw),e.rXU(m.sb),e.rXU(v),e.rXU(S.j),e.rXU(j.T),e.rXU(p.bg),e.rXU(R.W))};static \u0275cmp=e.VBU({type:a,selectors:[["app-rental-dialog"]],decls:59,vars:14,consts:[[1,"rental-dialog",3,"dir"],[1,"rental-form",3,"ngSubmit","formGroup"],[1,"form-grid-two"],[1,"form-field"],["type","text","pInputText","","formControlName","name",1,"w-full"],["type","text","pInputText","","formControlName","unitNumber",1,"w-full"],["pInputTextarea","","formControlName","description",1,"w-full",3,"rows"],["formControlName","brandId","optionLabel","name","optionValue","id",1,"w-full",3,"options"],["formControlName","activityId","optionLabel","name","optionValue","id",1,"w-full",3,"options"],["type","text","pInputText","","formControlName","location",1,"w-full"],["type","text","pInputText","","formControlName","responsiblePerson",1,"w-full"],["formControlName","rentType","optionLabel","label","optionValue","value",1,"w-full",3,"options"],["formControlName","contractDuration",1,"w-full",3,"min","showButtons"],["class","form-field",4,"ngIf"],["formControlName","salesCollectType","optionLabel","label","optionValue","value",1,"w-full",3,"options"],["formControlName","rentCollectType","optionLabel","label","optionValue","value",1,"w-full",3,"options"],[1,"form-actions"],["pButton","","type","button","label","Cancel",1,"p-button-secondary",3,"click"],["pButton","","type","submit","label","Save",3,"disabled"],["formControlName","rentValue",1,"w-full",3,"min","showButtons"],["formControlName","percentageValue",1,"w-full",3,"min","max","showButtons"],["formControlName","annualSales","prefix","$",1,"w-full",3,"min","showButtons"]],template:function(n,r){if(1&n&&(e.j41(0,"div",0)(1,"h3"),e.EFF(2),e.k0s(),e.j41(3,"form",1),e.bIt("ngSubmit",function(){return r.onSubmit()}),e.j41(4,"div",2)(5,"div",3)(6,"label"),e.EFF(7,"Name *"),e.k0s(),e.nrm(8,"input",4),e.k0s(),e.j41(9,"div",3)(10,"label"),e.EFF(11,"Unit Number *"),e.k0s(),e.nrm(12,"input",5),e.k0s()(),e.j41(13,"div",3)(14,"label"),e.EFF(15,"Description"),e.k0s(),e.nrm(16,"textarea",6),e.k0s(),e.j41(17,"div",2)(18,"div",3)(19,"label"),e.EFF(20,"Brand *"),e.k0s(),e.nrm(21,"p-dropdown",7),e.k0s(),e.j41(22,"div",3)(23,"label"),e.EFF(24,"Activity *"),e.k0s(),e.nrm(25,"p-dropdown",8),e.k0s()(),e.j41(26,"div",2)(27,"div",3)(28,"label"),e.EFF(29,"Location *"),e.k0s(),e.nrm(30,"input",9),e.k0s(),e.j41(31,"div",3)(32,"label"),e.EFF(33,"Responsible Person *"),e.k0s(),e.nrm(34,"input",10),e.k0s()(),e.j41(35,"div",3)(36,"label"),e.EFF(37,"Rent Type *"),e.k0s(),e.nrm(38,"p-dropdown",11),e.k0s(),e.j41(39,"div",2)(40,"div",3)(41,"label"),e.EFF(42,"Contract Duration (months) *"),e.k0s(),e.nrm(43,"p-inputNumber",12),e.k0s(),e.DNE(44,$,4,2,"div",13),e.k0s(),e.j41(45,"div",2),e.DNE(46,V,7,5,"div",13),e.k0s(),e.j41(47,"div",2)(48,"div",3)(49,"label"),e.EFF(50,"Sales Collect Type *"),e.k0s(),e.nrm(51,"p-dropdown",14),e.k0s(),e.j41(52,"div",3)(53,"label"),e.EFF(54,"Rent Collect Type *"),e.k0s(),e.nrm(55,"p-dropdown",15),e.k0s()(),e.j41(56,"div",16)(57,"button",17),e.bIt("click",function(){return r.ref.close()}),e.k0s(),e.nrm(58,"button",18),e.k0s()()()),2&n){let i,d;e.Y8G("dir","ar"===r.i18n.getCurrentLanguage()?"rtl":"ltr"),e.R7$(2),e.JRh(r.i18n.translate(r.isEditMode?"rentals.edit":"rentals.add")),e.R7$(),e.Y8G("formGroup",r.rentalForm),e.R7$(13),e.Y8G("rows",4),e.R7$(5),e.Y8G("options",r.brands),e.R7$(4),e.Y8G("options",r.activities),e.R7$(13),e.Y8G("options",r.rentTypeOptions),e.R7$(5),e.Y8G("min",1)("showButtons",!0),e.R7$(),e.Y8G("ngIf",1===(null==(i=r.rentalForm.get("rentType"))?null:i.value)),e.R7$(2),e.Y8G("ngIf",2===(null==(d=r.rentalForm.get("rentType"))?null:d.value)),e.R7$(5),e.Y8G("options",r.salesCollectOptions),e.R7$(4),e.Y8G("options",r.rentCollectOptions),e.R7$(3),e.Y8G("disabled",r.rentalForm.invalid)}},dependencies:[c.bT,l.qT,l.me,l.BC,l.cb,l.j4,l.JD,y._f,C.S,O.YI,P.ms,E.Z],styles:[".form-grid-two[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem}@media (max-width: 768px){.form-grid-two[_ngcontent-%COMP%]{grid-template-columns:1fr}}.rental-dialog[_ngcontent-%COMP%]{padding:1.5rem;min-width:600px}.rental-dialog[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1.5rem;font-size:1.5rem;font-weight:600}.rental-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}.form-field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-field.full-width[_ngcontent-%COMP%]{grid-column:1 / -1}.form-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#333}.income-display[_ngcontent-%COMP%]{padding:1rem;background:#f0f9ff;border-radius:4px;border-left:4px solid #3b82f6}[dir=rtl][_ngcontent-%COMP%]   .income-display[_ngcontent-%COMP%]{border-left:none;border-right:4px solid #3b82f6}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.5rem;margin-top:1rem;padding-top:1rem;border-top:1px solid #e0e0e0}.w-full[_ngcontent-%COMP%]{width:100%}[dir=rtl][_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{justify-content:flex-start}[dir=rtl][_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{text-align:right}@media (max-width: 768px){.rental-dialog[_ngcontent-%COMP%]{min-width:auto;width:100%}.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})}return a})();var _=o(9245),w=o(935),k=o(1830);const D=()=>["brandName","rentalType"];function U(a,s){if(1&a){const t=e.RV6();e.j41(0,"button",9),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.openAddDialog())}),e.k0s()}if(2&a){const t=e.XpG();e.FS9("label",t.i18n.translate("rentals.add"))}}function G(a,s){if(1&a){const t=e.RV6();e.j41(0,"div",10)(1,"span",11),e.nrm(2,"i",12),e.j41(3,"input",13),e.bIt("input",function(r){e.eBV(t),e.XpG();const i=e.sdS(8);return e.Njj(i.filterGlobal(r.target.value,"contains"))}),e.k0s()()()}if(2&a){const t=e.XpG();e.R7$(3),e.Y8G("placeholder",t.i18n.translate("common.search"))}}function N(a,s){if(1&a&&(e.j41(0,"th"),e.EFF(1),e.k0s()),2&a){const t=e.XpG(2);e.R7$(),e.JRh(t.i18n.translate("common.edit"))}}function X(a,s){if(1&a&&(e.j41(0,"th"),e.EFF(1),e.k0s()),2&a){const t=e.XpG(2);e.R7$(),e.JRh(t.i18n.translate("common.delete"))}}function A(a,s){if(1&a&&(e.j41(0,"tr")(1,"th"),e.EFF(2),e.k0s(),e.j41(3,"th"),e.EFF(4),e.k0s(),e.j41(5,"th"),e.EFF(6),e.k0s(),e.j41(7,"th"),e.EFF(8),e.k0s(),e.j41(9,"th"),e.EFF(10),e.k0s(),e.j41(11,"th"),e.EFF(12),e.k0s(),e.DNE(13,N,2,1,"th",14)(14,X,2,1,"th",14),e.k0s()),2&a){const t=e.XpG();e.R7$(2),e.JRh(t.i18n.translate("rentals.brand")),e.R7$(2),e.JRh(t.i18n.translate("rentals.unitNumber")),e.R7$(2),e.JRh(t.i18n.translate("rentals.rentalType")),e.R7$(2),e.JRh(t.i18n.translate("rentals.rentalAmount")),e.R7$(2),e.JRh(t.i18n.translate("rentals.startDate")),e.R7$(2),e.JRh(t.i18n.translate("rentals.expectedAnnualIncome")),e.R7$(),e.Y8G("ngIf",t.canEdit()),e.R7$(),e.Y8G("ngIf",t.canDelete())}}function B(a,s){if(1&a){const t=e.RV6();e.j41(0,"td")(1,"button",16),e.bIt("click",function(){e.eBV(t);const r=e.XpG().$implicit,i=e.XpG();return e.Njj(i.navigateToSaleRent(r))}),e.k0s()()}}function Y(a,s){if(1&a){const t=e.RV6();e.j41(0,"td")(1,"button",17),e.bIt("click",function(){e.eBV(t);const r=e.XpG().$implicit,i=e.XpG();return e.Njj(i.deleteRental(r))}),e.k0s()()}}function J(a,s){if(1&a&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.nrm(6,"p-tag",15),e.k0s(),e.j41(7,"td"),e.EFF(8),e.nI1(9,"currency"),e.k0s(),e.j41(10,"td"),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td"),e.EFF(14),e.nI1(15,"currency"),e.k0s(),e.DNE(16,B,2,0,"td",14)(17,Y,2,0,"td",14),e.k0s()),2&a){const t=s.$implicit,n=e.XpG();e.R7$(2),e.JRh(t.name),e.R7$(2),e.JRh(t.unitNumber),e.R7$(2),e.Y8G("value","Fixed"===t.rentType?"Monthly Rent":"Percentage")("severity","MonthlyRent"===t.rentType?"info":"success"),e.R7$(2),e.SpI(" ",t.rentValue?e.bMT(9,9,t.rentValue):t.percentageValue+"%"," "),e.R7$(3),e.JRh(e.i5U(12,11,t.createdOn,"shortDate")),e.R7$(3),e.JRh(e.bMT(15,14,t.expectedAnnualIncome)),e.R7$(2),e.Y8G("ngIf",n.canEdit()),e.R7$(),e.Y8G("ngIf",n.canDelete())}}let L=(()=>{class a{rentalService;brandService;messageService;confirmationService;dialogService;i18n;router;rentals=[];loading=!1;ref;constructor(t,n,r,i,d,g,h){this.rentalService=t,this.brandService=n,this.messageService=r,this.confirmationService=i,this.dialogService=d,this.i18n=g,this.router=h}ngOnInit(){this.loadRentals()}loadRentals(){this.loading=!0,this.rentalService.getAllRentals().subscribe({next:t=>{this.rentals=t.map(n=>({id:n.id,name:n.name??n.brand?.name??"",description:n.description??n.activity?.name??"",unitNumber:n.unitNumber??"",imageUrl:n.imageUrl??null,rentValue:n.rentValue,rentalAmount:n.rentValue,rentType:n.rentType,salesCollectType:n.salesCollectType??"",rentCollectType:n.rentCollectType??"",activityId:n.activityId??"",activity:n.activity??void 0,brandId:n.brandId??"",brand:n.brand??void 0,parentTenantId:n.parentTenantId??null,createdOn:new Date(n.createdOn),startDate:new Date(n.createdOn),expectedAnnualIncome:n.rentValue??0,contractDuration:n.contractDuration??void 0,responsiblePerson:n.responsiblePerson??void 0,location:n.location??void 0,annualSales:n.annualSales??void 0,percentageValue:n.percentageValue??void 0,expectedRevenue:n.expectedRevenue??0})),this.loading=!1},error:()=>{this.loading=!1,this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load rentals"})}})}navigateToSaleRent(t){const n=t?.tenantId||t?.id||t?.tenantID;n?this.router.navigate(["/rentals/sale-rant",n]):console.error("No tenant ID found in rental object",t)}openAddDialog(){this.ref=this.dialogService.open(T,{header:this.i18n.translate("rentals.add"),width:"70%",contentStyle:{"max-height":"90vh",overflow:"auto"},baseZIndex:1e4,data:{rental:null}}),this.ref.onClose.subscribe(t=>{t&&this.loadRentals()})}openEditDialog(t){this.ref=this.dialogService.open(T,{header:this.i18n.translate("rentals.edit"),width:"70%",contentStyle:{"max-height":"90vh",overflow:"auto"},baseZIndex:1e4,data:{rental:t}}),this.ref.onClose.subscribe(n=>{n&&this.loadRentals()})}deleteRental(t){this.confirmationService.confirm({message:"Are you sure you want to delete this rental?",header:"Confirm Delete",icon:"pi pi-exclamation-triangle",accept:()=>{this.rentalService.deleteRental(t.id).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Success",detail:"Rental deleted successfully"}),this.loadRentals()},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to delete rental"})}})}})}canEdit(){return!0}canDelete(){return!0}static \u0275fac=function(n){return new(n||a)(e.rXU(v),e.rXU(S.j),e.rXU(p.bg),e.rXU(p.td),e.rXU(m.o3),e.rXU(R.W),e.rXU(f.Ix))};static \u0275cmp=e.VBU({type:a,selectors:[["app-rentals"]],decls:12,vars:8,consts:[["dt",""],[1,"rentals-container"],[1,"p-toolbar-group-start"],[1,"p-toolbar-group-end"],["pButton","","icon","pi pi-plus",3,"label","click",4,"ngIf"],["styleClass","p-datatable-striped",3,"value","paginator","rows","globalFilterFields","loading"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pButton","","icon","pi pi-plus",3,"click","label"],[1,"table-header"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text",3,"input","placeholder"],[4,"ngIf"],[3,"value","severity"],["pButton","","icon","pi pi-pencil",1,"p-button-rounded","p-button-text",3,"click"],["pButton","","icon","pi pi-trash",1,"p-button-rounded","p-button-text","p-button-danger",3,"click"]],template:function(n,r){1&n&&(e.j41(0,"div",1)(1,"p-toolbar")(2,"div",2)(3,"h2"),e.EFF(4),e.k0s()(),e.j41(5,"div",3),e.DNE(6,U,1,1,"button",4),e.k0s()(),e.j41(7,"p-table",5,0),e.DNE(9,G,4,1,"ng-template",6)(10,A,15,8,"ng-template",7)(11,J,18,16,"ng-template",8),e.k0s()()),2&n&&(e.R7$(4),e.JRh(r.i18n.translate("rentals.title")),e.R7$(2),e.Y8G("ngIf",r.canEdit()),e.R7$(),e.Y8G("value",r.rentals)("paginator",!0)("rows",10)("globalFilterFields",e.lJ4(7,D))("loading",r.loading))},dependencies:[c.bT,y._f,p.Ei,C.S,_.XI,w.v,k.M,c.oe,c.vh],styles:[".rentals-container[_ngcontent-%COMP%], [dir=rtl][_ngcontent-%COMP%]   .rentals-container[_ngcontent-%COMP%], [dir=ltr][_ngcontent-%COMP%]   .rentals-container[_ngcontent-%COMP%]{padding:2rem}.table-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}[dir=rtl][_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]{flex-direction:row-reverse}"]})}return a})();var W=o(7468);let Z=(()=>{class a{fb;ref;config;rentalService;activatedRoute;messageService;i18n;saleRentForm;isEditMode=!1;expectedAnnualIncome=0;TenantId;constructor(t,n,r,i,d,g,h){this.fb=t,this.ref=n,this.config=r,this.rentalService=i,this.activatedRoute=d,this.messageService=g,this.i18n=h}ngOnInit(){this.TenantId=this.config.data?.rental,console.log("Dialog TenantId = ",this.TenantId),this.saleRentForm=this.fb.group({salesValue:["",l.k0.required],rentValue:["",l.k0.required],period:["",l.k0.required]})}onSubmit(){if(!this.saleRentForm.valid||!this.TenantId)return;const t=this.saleRentForm.value,r={salesValue:t.salesValue,period:t.period,tenantId:this.TenantId};(0,W.p)({rent:this.rentalService.createRents({rentValue:t.rentValue,period:t.period,tenantId:this.TenantId}),sales:this.rentalService.createSales(r)}).subscribe({next:i=>{this.messageService.add({severity:"success",summary:"Success",detail:"Sales & Rent created successfully"}),this.ref.close(i)},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to create rent or sales"})}})}static \u0275fac=function(n){return new(n||a)(e.rXU(l.ok),e.rXU(m.Pw),e.rXU(m.sb),e.rXU(v),e.rXU(f.nX),e.rXU(p.bg),e.rXU(R.W))};static \u0275cmp=e.VBU({type:a,selectors:[["app-sale-rent-dialog"]],decls:20,vars:4,consts:[[1,"rental-dialog",3,"dir"],[1,"rental-form",3,"ngSubmit","formGroup"],[1,"form-grid-two"],[1,"form-field"],["type","text","pInputText","","formControlName","salesValue",1,"w-full"],["type","text","pInputText","","formControlName","rentValue",1,"w-full"],["type","date","pInputText","","formControlName","period",1,"w-full"],[1,"form-actions"],["pButton","","type","button","label","Cancel",1,"p-button-secondary",3,"click"],["pButton","","type","submit","label","Save",3,"disabled"]],template:function(n,r){1&n&&(e.j41(0,"div",0)(1,"h3"),e.EFF(2),e.k0s(),e.j41(3,"form",1),e.bIt("ngSubmit",function(){return r.onSubmit()}),e.j41(4,"div",2)(5,"div",3)(6,"label"),e.EFF(7,"Sales Value *"),e.k0s(),e.nrm(8,"input",4),e.k0s(),e.j41(9,"div",3)(10,"label"),e.EFF(11,"Rent Value *"),e.k0s(),e.nrm(12,"input",5),e.k0s(),e.j41(13,"div",3)(14,"label"),e.EFF(15,"Period *"),e.k0s(),e.nrm(16,"input",6),e.k0s()(),e.j41(17,"div",7)(18,"button",8),e.bIt("click",function(){return r.ref.close()}),e.k0s(),e.nrm(19,"button",9),e.k0s()()()),2&n&&(e.Y8G("dir","ar"===r.i18n.getCurrentLanguage()?"rtl":"ltr"),e.R7$(2),e.JRh(r.i18n.translate(r.isEditMode?"rentals.edit":"rentals.sale")),e.R7$(),e.Y8G("formGroup",r.saleRentForm),e.R7$(16),e.Y8G("disabled",r.saleRentForm.invalid))},dependencies:[l.qT,l.me,l.BC,l.cb,l.j4,l.JD,y._f,C.S],styles:[".form-grid-two[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem}@media (max-width: 768px){.form-grid-two[_ngcontent-%COMP%]{grid-template-columns:1fr}}.rental-dialog[_ngcontent-%COMP%]{padding:1.5rem;min-width:600px}.rental-dialog[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1.5rem;font-size:1.5rem;font-weight:600}.rental-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}.form-field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-field.full-width[_ngcontent-%COMP%]{grid-column:1 / -1}.form-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#333}.income-display[_ngcontent-%COMP%]{padding:1rem;background:#f0f9ff;border-radius:4px;border-left:4px solid #3b82f6}[dir=rtl][_ngcontent-%COMP%]   .income-display[_ngcontent-%COMP%]{border-left:none;border-right:4px solid #3b82f6}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.5rem;margin-top:1rem;padding-top:1rem;border-top:1px solid #e0e0e0}.w-full[_ngcontent-%COMP%]{width:100%}[dir=rtl][_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{justify-content:flex-start}[dir=rtl][_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{text-align:right}@media (max-width: 768px){.rental-dialog[_ngcontent-%COMP%]{min-width:auto;width:100%}.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})}return a})();function Q(a,s){1&a&&(e.j41(0,"tr")(1,"th"),e.EFF(2,"Period"),e.k0s(),e.j41(3,"th"),e.EFF(4,"Rent Value"),e.k0s()())}function z(a,s){if(1&a&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.nI1(3,"date"),e.k0s(),e.j41(4,"td"),e.EFF(5),e.nI1(6,"currency"),e.k0s()()),2&a){const t=s.$implicit;e.R7$(2),e.JRh(e.i5U(3,2,t.period,"MMMM yyyy")),e.R7$(3),e.JRh(e.bMT(6,5,t.rentValue))}}function H(a,s){1&a&&(e.j41(0,"tr")(1,"th"),e.EFF(2,"Label"),e.k0s(),e.j41(3,"th"),e.EFF(4,"Sales Value"),e.k0s()())}function K(a,s){if(1&a&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.nI1(5,"currency"),e.k0s()()),2&a){const t=s.$implicit;e.R7$(2),e.JRh(t.label),e.R7$(2),e.JRh(e.bMT(5,2,t.salesValue))}}let q=(()=>{class a{rentalService;activatedRoute;messageService;i18n;dialogService;Rent=[];Sales=[];TenantId;loading=!1;ref;constructor(t,n,r,i,d){this.rentalService=t,this.activatedRoute=n,this.messageService=r,this.i18n=i,this.dialogService=d}ngOnInit(){this.TenantId=this.activatedRoute.snapshot.paramMap.get("tenantId"),console.log("TenantId:",this.TenantId),this.loadRent(),this.loadSales()}loadRent(){this.loading=!0,this.rentalService.getAllRent(this.TenantId).subscribe({next:t=>{this.Rent=t?.years?.[0]?.rentTypes?.[0]?.items||[],console.log("Rent items:",this.Rent),this.loading=!1},error:()=>{this.loading=!1,this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load rent data"})}})}loadSales(){this.loading=!0,this.rentalService.getAllSales(this.TenantId).subscribe({next:t=>{this.Sales=t?.years?.[0]?.salesTypes?.[0]?.items||[],console.log("Sales items:",this.Sales),this.loading=!1},error:()=>{this.loading=!1,this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load sales data"})}})}openAddDialog(){this.ref=this.dialogService.open(Z,{header:this.i18n.translate("rentals.sale"),width:"70%",contentStyle:{"max-height":"90vh",overflow:"auto"},baseZIndex:1e4,data:{rental:this.TenantId}}),this.ref.onClose.subscribe(t=>{t&&(this.loadSales(),this.loadRent())})}static \u0275fac=function(n){return new(n||a)(e.rXU(v),e.rXU(f.nX),e.rXU(p.bg),e.rXU(R.W),e.rXU(m.o3))};static \u0275cmp=e.VBU({type:a,selectors:[["app-sale-rent"]],decls:20,vars:4,consts:[[1,"rentals-container"],[1,"p-toolbar-group-start"],[1,"p-toolbar-group-end"],["pButton","","icon","pi pi-plus",3,"click","label"],[1,"tables-wrapper"],[1,"table-box"],["styleClass","p-datatable-gridlines",3,"value"],["pTemplate","header"],["pTemplate","body"]],template:function(n,r){1&n&&(e.j41(0,"div",0)(1,"p-toolbar")(2,"div",1)(3,"h2"),e.EFF(4),e.k0s()(),e.j41(5,"div",2)(6,"button",3),e.bIt("click",function(){return r.openAddDialog()}),e.k0s()()(),e.j41(7,"div",4)(8,"div",5)(9,"h3"),e.EFF(10,"Rent Details"),e.k0s(),e.j41(11,"p-table",6),e.DNE(12,Q,5,0,"ng-template",7)(13,z,7,7,"ng-template",8),e.k0s()(),e.j41(14,"div",5)(15,"h3"),e.EFF(16,"Sales Details"),e.k0s(),e.j41(17,"p-table",6),e.DNE(18,H,5,0,"ng-template",7)(19,K,6,4,"ng-template",8),e.k0s()()()()),2&n&&(e.R7$(4),e.JRh(r.i18n.translate("rentals.title")),e.R7$(2),e.FS9("label",r.i18n.translate("rentals.sale")),e.R7$(5),e.Y8G("value",r.Rent),e.R7$(6),e.Y8G("value",r.Sales))},dependencies:[y._f,p.Ei,_.XI,k.M,c.oe,c.vh],styles:[".rentals-container[_ngcontent-%COMP%], [dir=rtl][_ngcontent-%COMP%]   .rentals-container[_ngcontent-%COMP%], [dir=ltr][_ngcontent-%COMP%]   .rentals-container[_ngcontent-%COMP%]{padding:2rem}.table-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}[dir=rtl][_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]{flex-direction:row-reverse}"]})}return a})(),ee=(()=>{class a{static \u0275fac=function(n){return new(n||a)};static \u0275mod=e.$C({type:a});static \u0275inj=e.G2t({imports:[c.MD,l.X1,I.G,f.iI.forChild([{path:"",component:L},{path:"sale-rant/:tenantId",component:q}])]})}return a})()}}]);